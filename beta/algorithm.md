# グラフ彩色問題（GCP）のための並列遺伝的アルゴリズム（PGA）実装、アルゴリズムと数式について。

まず、第一世代を生成する。このとき、個体（グラフの図）は式 (2) を用いてベクトル表現

$$
p = \langle c(1), c(2), \dots, c(n) \rangle \tag{5}
$$

と表せる。ここで、$n$ はグラフの頂点の数であり、$p(i) \in \{1, 2, \dots, k\}$ である。また、世代を $t$、各島の個体数を $M$（すべての島で同数）とし、各島を $i \in \{1, \dots, L\}$（$L$ は島の総数）とすると、島 $P$ は、

$$
P_{j}^{(t)} = \{ p_{j,1}^{(t)}, p_{j,2}^{(t)}, \dots, p_{j,M}^{(t)} \} \tag{6}
$$

と表せる。よって、1世代は、

$$
\mathcal{P}^{(t)} = ( P_{1}^{(t)}, P_{2}^{(t)}, \dots, P_{L}^{(t)} ) \tag{7}
$$

と表すことができる。

次に、この個体に関して評価を行う。式(3)を満たさないエッジの集合にペナルティを与える関数を $(u,v) \in E$ について、

$$
q(u,v) = \begin{cases} 
2 & (c(u) = c(v)) \\ 
0 & (c(u) \neq c(v)) 
\end{cases} \tag{8}
$$

と定める。また、コンフリクトを含む個体に対して罰を与える関数 $d$ を、

$$
d = \begin{cases} 
1 & (\sum_{(u,v) \in E} q(u,v) > 0) \\ 
0 & (\sum_{(u,v) \in E} q(u,v) = 0) 
\end{cases} \tag{9}
$$

と定める。この $d$ は、探索初期において、コンフリクトを軽視させないために導入されている。上記式(8)と式(9) そして式(4)の $k$ を用いて、コスト関数を、

$$
f(p_{i}) = \sum_{(u,v) \in E} q(u,v) + d + k \tag{10}
$$

と表す。この $f(p)$ の逆数を個体の評価値とする。

評価値をもとに、ルーレット選択を行う。ルーレット選択では、ルーレットのマスの面積を評価値の比と等しくなるように分けることで、評価値の高いものほど選ばれやすくなる選択方法である。評価値 $F$ は、

$$
F(p_{i}) = \frac{1}{f(p_{i})} \tag{11}
$$

であり、個体 $p_i$ が親として選択される確率は、

$$
q(p_{i}) = \frac{F(p_{i})}{\sum_{j=1}^{M} F(p_{j})} \tag{12}
$$

となる。

ルーレット選択で選ばれた親から次の世代の個体、すなわち子を作る。子を作る交叉において、コンフリクト解消交叉を用いる。これはまず、親個体のペアから $P_{father}$ のコピー $s_{boy}$ と $P_{mother}$ のコピー $s_{girl}$ を生成する。そして、その子のコンフリクトしている頂点をコピー元でない方の親の情報で上書きする。つまり、$s_{girl}$ の $i$ 番目の頂点の $\mathfrak{G}s_{girl}[i]$ は、$s_{girl}$ のコンフリクトを起こしている頂点の集合を $V_{conflict}$ とすると、

$$
s_{girl}[i] = \begin{cases} 
p_{mother}[i] & (s_{girl}[i] \in V_{conflict}) \\ 
p_{father}[i] & (s_{girl}[i] \notin V_{conflict}) 
\end{cases} \tag{13}
$$

と表される。

また、遺伝的アルゴリズムでは局所解に陥った場合に、それを打破するために突然変異という進化を促す仕組みを組み込むことが多い。本レポートでは文献[2]から転置を行う方式を採用する。交叉後にランダムに個体内の異なる2頂点を入れ替える形をとり、$(u,v) \in E, u \neq v$ について、置き換え後の色をそれぞれ $c'(u), c'(v)$ について、

$$
c'(u) = c(v) \tag{14}
$$
$$
c'(v) = c(u) \tag{15}
$$

となる。

島モデルには、各 $P$ 間を移動する移住システムがある。今回は文献[2]にあるように最良個体1個体をすべての島に送る形をとる。10世代ごとに、最良個体を他全ての島に送り出すが、受け入れ先では多様性を維持するためランダムで置換を行う。各島の最良個体を $b_{i}^{(t)}$ とすると、それらをコピーした集合 $B^{(t)}$ は、

$$
B^{(t)} = \{ b_{1}^{(t)}, b_{2}^{(t)}, \dots, b_{L}^{(t)} \} \tag{16}
$$

となる。そして、その集合から自身を除くすべての島に最良個体を送る、すなわち自身以外の島から送られてきた最良個体を、自身の島の個体をランダムで上書きする形で受け入れる。すなわち、そのランダムで消去される個体の集合を $R_{j}^{(t)}$ とすれば、

$$
p_{j}^{(t+1)} = (p_{j}^{(t)} \setminus R_{j}^{(t)}) \cup \bigcup_{n=1, n \neq j}^{L} b_{n}^{(t)} \tag{17}
$$

となる。以上の操作を繰り返し、

$$
F(p_{i}) = 0.25 \tag{18}
$$

となる個体が生まれるまで、指定した数に達するまで世代交代を行う。

---